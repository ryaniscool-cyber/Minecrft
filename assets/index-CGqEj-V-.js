import*as o from"https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js";import{PointerLockControls as k}from"https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/controls/PointerLockControls.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))w(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&w(s)}).observe(document,{childList:!0,subtree:!0});function l(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function w(e){if(e.ep)return;e.ep=!0;const t=l(e);fetch(e.href,t)}})();let c,i,u,n,b=document.getElementById("overlay"),m=!1,y=!1,p=!1,h=!1,g=!1,r=new o.Vector3,f=new o.Vector3;x();L();function x(){i=new o.Scene,i.background=new o.Color(8900331),c=new o.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),u=new o.WebGLRenderer({antialias:!0}),u.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(u.domElement),n=new k(c,document.body),i.add(n.getObject()),b.addEventListener("click",()=>{n.lock()}),n.addEventListener("lock",()=>{b.classList.add("hidden")}),n.addEventListener("unlock",()=>{b.classList.remove("hidden")});const a=new o.PlaneGeometry(200,200,10,10),d=new o.MeshStandardMaterial({color:2263842}),l=new o.Mesh(a,d);l.rotation.x=-Math.PI/2,l.receiveShadow=!0,i.add(l);const w=new o.BoxGeometry(2,2,2),e=new o.MeshStandardMaterial({color:16711680}),t=new o.Mesh(w,e);t.position.set(0,1,-5),i.add(t);const s=new o.DirectionalLight(16777215,1);s.position.set(10,20,10),i.add(s);const v=new o.AmbientLight(4210752);i.add(v),document.addEventListener("keydown",A),document.addEventListener("keyup",z),window.addEventListener("resize",E),c.position.y=2}function A(a){switch(a.code){case"ArrowUp":case"KeyW":m=!0;break;case"ArrowLeft":case"KeyA":p=!0;break;case"ArrowDown":case"KeyS":y=!0;break;case"ArrowRight":case"KeyD":h=!0;break;case"Space":g&&(r.y+=5),g=!1;break}}function z(a){switch(a.code){case"ArrowUp":case"KeyW":m=!1;break;case"ArrowLeft":case"KeyA":p=!1;break;case"ArrowDown":case"KeyS":y=!1;break;case"ArrowRight":case"KeyD":h=!1;break}}function E(){c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)}function L(){requestAnimationFrame(L),n.isLocked&&(r.x-=r.x*10*.05,r.z-=r.z*10*.05,r.y-=9.8*5*.05,f.z=Number(m)-Number(y),f.x=Number(h)-Number(p),f.normalize(),(m||y)&&(r.z-=f.z*50*.05),(p||h)&&(r.x-=f.x*50*.05),n.moveRight(-r.x*.05),n.moveForward(-r.z*.05),n.getObject().position.y+=r.y*.05,n.getObject().position.y<2&&(r.y=0,n.getObject().position.y=2,g=!0)),u.render(i,c)}
